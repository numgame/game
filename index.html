<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Number Tracker Game</title>
    <!-- Import Montserrat Font -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="version">V1.7</div>
    <div class="password-container">
        <div class="header">Number Game</div>
        <script>
// Version: v1.7
// If updating, increment version number and retain this comment

class NumberTracker {
  constructor() {
    // Define valid numbers for the game (including "00")
    this.validNumbers = new Set([0, "00", 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36]);
    
    // Map numbers to their colors (red, black, green)
    this.colorMap = {
      red: new Set([1, 3, 5, 7, 9, 12, 14, 16, 18, 19, 21, 23, 25, 27, 30, 32, 34, 36]),
      black: new Set([2, 4, 6, 8, 10, 11, 13, 15, 17, 20, 22, 24, 26, 28, 29, 31, 33, 35]),
      green: new Set([0, "00"])
    };
    
    // Load numbers from localStorage or initialize with an empty array
    this.numbers = JSON.parse(localStorage.getItem("numbers")) || [];
    
    // Initialize other properties
    this.undoStack = [];
    this.recognition = null;
    this.alerts = []; // Track active alerts
    this.checkPassword();
  }

  // Check password before allowing access to the game
  checkPassword() {
    const passwordContainer = document.querySelector(".password-container");
    
    const passwordInput = document.createElement("input");
    passwordInput.type = "password";
    passwordInput.placeholder = "Enter password";
    
    const submitButton = document.createElement("button");
    submitButton.textContent = "Submit";
    submitButton.addEventListener("click", () => this.submitPassword(passwordInput));
    
    // Submit password on Enter key
    passwordInput.addEventListener("keydown", (e) => {
      if (e.key === "Enter") this.submitPassword(passwordInput);
    });
    
    passwordContainer.append(passwordInput, submitButton);
  }

  // Submit password and initialize the game if correct
  submitPassword(passwordInput) {
    if (passwordInput.value === "paul") {
      document.querySelector(".password-container").style.display = "none"; // Hide password container
      this.createUI();
      this.render();
    } else {
      alert("Incorrect password. Try again.");
    }
  }

  // Create the game UI (input field, buttons, etc.)
  createUI() {
    const gameContainer = document.createElement("div");
    gameContainer.className = "game-container";
    document.body.appendChild(gameContainer);

    // Create button container for Reset and Smaller
    const buttonContainer = document.createElement("div");
    buttonContainer.style.display = "flex";
    buttonContainer.style.gap = "5px";
    buttonContainer.style.margin = "5px";

    // Reset button
    const resetButton = document.createElement("button");
    resetButton.textContent = "Reset";
    resetButton.addEventListener("click", () => this.resetGame());

    // Smaller button
    const smallerButton = document.createElement("button");
    smallerButton.textContent = "Smaller";
    smallerButton.addEventListener("click", () => this.toggleGameContainerSize());

    // Add buttons to container
    buttonContainer.append(resetButton, smallerButton);
    document.body.insertBefore(buttonContainer, gameContainer);

    // Add header
    const header = document.createElement("div");
    header.className = "header";
    header.textContent = "Number Game";
    gameContainer.appendChild(header);
    
    // Create numbers container
    this.numbersContainer = document.createElement("div");
    this.numbersContainer.className = "container";
    
    // Input field
    this.inputField = document.createElement("input");
    this.inputField.type = "text";
    this.inputField.placeholder = "Enter a number";
    this.inputField.inputMode = "tel";
    this.inputField.addEventListener("keydown", (e) => this.handleKeydown(e));
    
    // Undo button
    this.undoButton = document.createElement("button");
    this.undoButton.textContent = "Undo";
    this.undoButton.addEventListener("click", () => this.undoLastEntry());
    
    // Enter button
    this.enterButton = document.createElement("button");
    this.enterButton.textContent = "Enter";
    this.enterButton.addEventListener("click", () => {
      const input = this.inputField.value.trim();
      if (input) {
        this.processInput(input);
        this.inputField.value = "";
        this.inputField.focus();
      }
    });
    
    // Alert container
    this.alertContainer = document.createElement("div");
    this.alertContainer.className = "alert-container";
    this.alertContainer.innerHTML = "<h3>Active Alerts</h3>";
    
    // Alert buttons
    const alertButtons = document.createElement("div");
    alertButtons.className = "alert-buttons";
    
    this.minimizeButton = document.createElement("button");
    this.minimizeButton.innerHTML = "&#9660;";
    this.minimizeButton.addEventListener("click", () => this.toggleMinimize());
    
    this.resizeButton = document.createElement("button");
    this.resizeButton.innerHTML = "&#9723;";
    this.resizeButton.addEventListener("click", () => this.toggleResize());
    
    alertButtons.append(this.minimizeButton, this.resizeButton);
    this.alertContainer.appendChild(alertButtons);
    
    this.warningMessage = document.createElement("div");
    this.warningMessage.className = "warning small-warning";
    
    this.errorMessage = document.createElement("p");
    this.errorMessage.className = "error-message";
    
    // Append elements
    gameContainer.append(
      this.numbersContainer,
      this.warningMessage,
      this.inputField,
      this.undoButton,
      this.enterButton,
      this.alertContainer,
      this.errorMessage
    );
  }

  // Toggle game container size
  toggleGameContainerSize() {
    const gameContainer = document.querySelector(".game-container");
    if (!gameContainer.classList.contains("small") && !gameContainer.classList.contains("smaller")) {
      gameContainer.classList.add("small");
    } else if (gameContainer.classList.contains("small")) {
      gameContainer.classList.remove("small");
      gameContainer.classList.add("smaller");
    } else if (gameContainer.classList.contains("smaller")) {
      gameContainer.classList.remove("smaller");
    }
  }

  // Toggle minimize alerts
  toggleMinimize() {
    this.alertContainer.classList.toggle("minimized");
    if (this.alertContainer.classList.contains("minimized")) {
      this.minimizeButton.innerHTML = "&#9658;"; // Right arrow symbol
    } else {
      this.minimizeButton.innerHTML = "&#9660;"; // Down arrow symbol
    }
  }

  // Toggle resize alerts
  toggleResize() {
    this.alertContainer.classList.toggle("small");
  }

  // Handle Enter key press in the input field
  handleKeydown(e) {
    if (e.key === "Enter") {
      const input = this.inputField.value.trim();
      if (input) {
        this.processInput(input);
        this.inputField.value = "";
        // Keep the keyboard open on mobile devices
        this.inputField.focus();
      }
    }
  }

  // Process the input number
  processInput(input) {
    // Handle "00" as a valid input
    const number = input === "00" ? "00" : parseInt(input, 10);
    
    // Validate the input
    if ((isNaN(number) && input !== "00") || !this.validNumbers.has(number)) {
      this.errorMessage.textContent = `Invalid number: ${input}. Please enter a valid number.`;
      return;
    }

    // Clear error message if input is valid
    this.errorMessage.textContent = "";

    // Ensure a maximum of 36 numbers
    if (this.numbers.length >= 36) {
      this.numbers.shift(); // Remove the first number
    }

    // Add the new number
    this.numbers.push(number);

    // Save to localStorage
    localStorage.setItem("numbers", JSON.stringify(this.numbers));

    // Render the updated list
    this.render();

    // Check for triplets and warnings
    this.checkForTriplets();
    this.checkForWarnings();
  }

  // Reset the game
  resetGame() {
    this.numbers = [];
    localStorage.setItem("numbers", JSON.stringify(this.numbers));
    this.render();
    this.alerts = [];
    this.alertContainer.innerHTML = "<h3>Active Alerts</h3>";
    this.warningMessage.textContent = "";
    this.errorMessage.textContent = "";
  }

  // Convert spoken words to numbers
  convertSpokenTextToNumber(spokenText) {
    const numberWords = {
      "zero": 0,
      "single zero": 0,
      "double zero": "00",
      "one": 1,
      "two": 2,
      "three": 3,
      "four": 4,
      "five": 5,
      "six": 6,
      "seven": 7,
      "eight": 8,
      "nine": 9,
      "ten": 10,
      "eleven": 11,
      "twelve": 12,
      "thirteen": 13,
      "fourteen": 14,
      "fifteen": 15,
      "sixteen": 16,
      "seventeen": 17,
      "eighteen": 18,
      "nineteen": 19,
      "twenty": 20,
      "thirty": 30,
      "thirty-six": 36
    };

    // Convert spoken text to lowercase for matching
    spokenText = spokenText.toLowerCase();

    // Check if the spoken text matches a number word
    if (numberWords.hasOwnProperty(spokenText)) {
      return numberWords[spokenText];
    }

    // Handle cases like "twenty one" (e.g., "twenty-one")
    if (spokenText.includes(" ")) {
      const parts = spokenText.split(" ");
      if (parts.length === 2 && numberWords.hasOwnProperty(parts[0]) && numberWords.hasOwnProperty(parts[1])) {
        return numberWords[parts[0]] + numberWords[parts[1]];
      }
    }

    return null; // Return null if no match is found
  }

  // Check for triplets and display alerts
  checkForTriplets() {
    const countMap = {};
    const newAlerts = new Set();
    
    // Count occurrences of each number
    for (const num of this.numbers) {
      countMap[num] = (countMap[num] || 0) + 1;
      if (countMap[num] >= 3) {  // Changed to check for >= 3 instead of === 3
        newAlerts.add(num);
      }
    }
    
    // Update alerts (newest at the top)
    const previousAlerts = new Set(this.alerts);
    this.alerts = [...newAlerts].reverse();
    
    // Clear the existing alerts but keep the buttons
    this.alertContainer.innerHTML = "<h3>Active Alerts</h3>";
    
    // Re-add the buttons
    const alertButtons = document.createElement("div");
    alertButtons.className = "alert-buttons";
    
    // Minimize button
    this.minimizeButton = document.createElement("button");
    this.minimizeButton.innerHTML = "&#9660;"; // Down arrow symbol
    this.minimizeButton.addEventListener("click", () => this.toggleMinimize());
    
    // Resize button
    this.resizeButton = document.createElement("button");
    this.resizeButton.innerHTML = "&#9723;"; // Square symbol
    this.resizeButton.addEventListener("click", () => this.toggleResize());
    
    alertButtons.append(this.minimizeButton, this.resizeButton);
    this.alertContainer.appendChild(alertButtons);
    
    // Display active alerts with dynamic counts
    this.alerts.forEach((num) => {
      const alert = document.createElement("div");
      alert.className = "alert";
      
      // Set background color based on number color
      if (this.colorMap.red.has(num)) {
        alert.style.backgroundColor = "#cc2020";
      } else if (this.colorMap.green.has(num)) {
        alert.style.backgroundColor = "#23913c";
      } else if (this.colorMap.black.has(num)) {
        alert.style.backgroundColor = "#1e1f22";
      }
      
      // Update text to show current count from countMap
      alert.textContent = `Number ${num} appears ${countMap[num]} times!`;
      this.alertContainer.appendChild(alert);
      
      // Animation logic remains the same
      if (!previousAlerts.has(num)) {
        setTimeout(() => alert.classList.add("show"), 10);
      } else {
        alert.classList.add("show");
      }
    });
  }

  // Check for warnings when a triplet is about to disappear
  checkForWarnings() {
    const firstNumber = this.numbers[0];
    if (firstNumber !== undefined) {
      const count = this.numbers.filter((n) => n === firstNumber).length;
      if (count === 3) {
        this.warningMessage.textContent = `Warning: Number ${firstNumber} (appears 3 times) is about to disappear!`;
      } else {
        this.warningMessage.textContent = "";
      }
    }
  }

  // Render the list of numbers
  render() {
    // Clear the existing numbers container
    this.numbersContainer.innerHTML = "";
    
    // Render the numbers (up to 36)
    const numbersToDisplay = this.numbers.slice(-36);
    for (let i = 0; i < 36; i++) {
      const span = document.createElement("span");
      span.textContent = numbersToDisplay[i] === 0 ? "0" : numbersToDisplay[i] || ""; // Display "0" for 0, blank for null/undefined
      
      if (this.colorMap.red.has(numbersToDisplay[i])) span.style.color = "red";
      else if (this.colorMap.black.has(numbersToDisplay[i])) span.style.color = "black";
      else if (this.colorMap.green.has(numbersToDisplay[i])) span.style.color = "green";
      
      this.numbersContainer.appendChild(span);
    }
  }

  // Undo the last entry
  undoLastEntry() {
    if (this.numbers.length > 0) {
      this.numbers.pop(); // Remove the last number
      localStorage.setItem("numbers", JSON.stringify(this.numbers));
      this.render();
    }
  }
}

new NumberTracker();
        </script>
    </div>
</body>
</html>
